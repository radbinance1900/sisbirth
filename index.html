<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Happy Birthday Didi üéÄ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Cute handwriting + rounded script for headings -->
  <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&family=Cookie&display=swap" rel="stylesheet"><!-- [web:3][web:5][web:17] -->

  <!-- JS Confetti (CDN, zero-config) -->
  <script src="https://cdn.jsdelivr.net/npm/js-confetti@latest/dist/js-confetti.browser.js"></script><!-- [web:10] -->

  <style>
    :root{
      --bg: #ffffff;
      --pink: #ff6fa5;
      --pink-dark: #e85c92;
      --pink-light: #ffd3e6;
      --shadow: rgba(0,0,0,0.12);
      --card: #fff7fb;
      --accent: #ff3d85;
      --ink: #5b2b3a;
    }

    *{ box-sizing: border-box; }
    html, body{
      height:100%;
      margin:0;
      background: var(--bg);
    }
    body{
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      font-family: 'Kalam', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
    }

    /* Scene wrapper */
    .scene{
      width:min(920px, 100%);
      aspect-ratio: 16/9;
      max-height: 92vh;
      position: relative;
      display:flex;
      align-items:center;
      justify-content:center;
      perspective: 1400px;
      isolation:isolate;
    }

    /* Envelope container */
    .envelope{
      width:min(540px, 85vw);
      height:min(360px, 56vw);
      position: relative;
      transform-style: preserve-3d;
      filter: drop-shadow(0 18px 28px var(--shadow));
      cursor: pointer;
      user-select: none;
    }

    /* Envelope base */
    .env-base{
      position:absolute;
      inset:0;
      background: linear-gradient(180deg, var(--pink) 0%, var(--pink-dark) 100%);
      border-radius: 16px;
      overflow: hidden;
    }

    /* Decorative envelope seams */
    .env-base::before,
    .env-base::after{
      content:'';
      position:absolute;
      inset:0;
      background:
        linear-gradient(135deg, rgba(255,255,255,0.35) 0 2px, transparent 0) top left,
        linear-gradient(-135deg, rgba(0,0,0,0.06) 0 2px, transparent 0) bottom right;
      background-size: 100% 50%, 100% 50%;
      mix-blend-mode: soft-light;
      pointer-events:none;
    }

    /* Bottom triangle flap to create envelope look */
    .env-bottom{
      position:absolute;
      inset:0;
      clip-path: polygon(0 100%, 50% 35%, 100% 100%);
      background: linear-gradient(180deg, var(--pink-light) 0%, #ffc0da 100%);
      transform: translateZ(1px);
    }

    /* Top flap rotates open */
    .env-top{
      position:absolute;
      left:0; right:0;
      top:0; height:55%;
      transform-origin: top center;
      background: linear-gradient(180deg, #ff8fba 0%, var(--pink) 100%);
      clip-path: polygon(0 0, 100% 0, 100% 100%, 50% 65%, 0 100%);
      border-top-left-radius: 16px;
      border-top-right-radius: 16px;
      box-shadow: 0 10px 20px var(--shadow);
      transition: transform 900ms cubic-bezier(.2,.8,.2,1);
      transform: rotateX(0deg) translateZ(2px);
      z-index: 4;
    }

    /* Wax heart seal */
    .seal{
      position:absolute;
      left:50%; top:52%;
      transform: translate(-50%, -50%);
      width:64px; height:64px;
      background: radial-gradient(circle at 30% 30%, #ff79a8 0 40%, #ff3d85 41% 100%);
      border-radius: 50%;
      box-shadow: 0 6px 14px rgba(0,0,0,0.18);
      display:grid;
      place-items:center;
      color:white;
      font-size:28px;
      z-index:5;
      transition: transform 300ms ease, opacity 300ms ease;
    }
    .envelope.open .seal{
      transform: translate(-50%, -50%) scale(.85);
      opacity:.0;
    }

    /* "for didi" handwriting on envelope */
    .for-didi{
      position:absolute;
      bottom:16%;
      left:50%;
      transform: translateX(-50%) rotate(-2deg);
      font-family: 'Cookie', cursive;
      font-size: clamp(22px, 4.2vw, 38px);
      color: #ffe9f3;
      text-shadow: 0 2px 0 rgba(0,0,0,0.12);
      letter-spacing:.5px;
      z-index: 3;
      pointer-events: none;
    }

    /* Letter card that slides out */
    .letter{
      position:absolute;
      left:50%;
      bottom:10%;
      transform: translate(-50%, 0) translateZ(0);
      width:calc(100% - 56px);
      height:calc(100% - 110px);
      background: linear-gradient(180deg, #ffffff 0%, var(--card) 100%);
      border-radius: 14px;
      box-shadow:
        0 10px 18px rgba(0,0,0,0.10),
        inset 0 -2px 0 rgba(0,0,0,0.05);
      padding: 24px 22px;
      z-index: 2;
      overflow: hidden;
      display:flex;
      align-items:flex-start;
      justify-content:flex-start;
      gap:12px;
      border: 1px solid #ffe0ef;
      transition: transform 900ms cubic-bezier(.2,.8,.2,1), box-shadow 900ms cubic-bezier(.2,.8,.2,1);
    }

    /* Decorative holes like stationery */
    .letter::before{
      content:'';
      position:absolute;
      left:14px; top:14px; bottom:14px;
      width:10px;
      background:
        radial-gradient(circle at 50% 12%, #ffd0e3 0 4px, transparent 5px) 0 0 / 10px 48px repeat-y;
      opacity:.9;
      pointer-events:none;
    }

    /* When open: flap rotates and letter slides up */
    .envelope.open .env-top{
      transform: rotateX(-155deg) translateZ(2px);
    }
    .envelope.open .letter{
      transform: translate(-50%, -46%) translateZ(0);
      box-shadow:
        0 22px 40px rgba(0,0,0,0.18),
        inset 0 -2px 0 rgba(0,0,0,0.05);
    }

    /* Header text inside the letter */
    .greet{
      width:100%;
      font-family: 'Cookie', cursive;
      font-size: clamp(28px, 5vw, 46px);
      color: var(--accent);
      margin: 4px 0 10px 0;
      letter-spacing:.3px;
      display:flex;
      align-items:center;
      gap:12px;
    }

    .divider{
      height: 2px;
      width: 100%;
      background: linear-gradient(90deg, transparent, #ffd0e4 30%, #ffc2dd 70%, transparent);
      border-radius: 2px;
      margin: 6px 0 10px 0;
    }

    /* Typewriter container */
    .typewriter{
      position: relative;
      font-size: clamp(16px, 2.4vw, 22px);
      line-height: 1.6;
      color: var(--ink);
      padding-right: 8px;
      white-space: pre-wrap;
      min-height: 8lh;
    }

    /* Caret blink */
    .caret{
      display:inline-block;
      width: 10px;
      height: 1.05em;
      margin-left: 2px;
      background: linear-gradient(180deg, #ff8fba 0%, #ff3d85 100%);
      border-radius: 2px;
      vertical-align: -2px;
      animation: blink 1s steps(1) infinite;
    }
    @keyframes blink{
      0%,49%{ opacity:1; }
      50%,100%{ opacity:0; }
    }

    /* Floating hearts on open */
    .float-hearts{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index: 6;
    }
    .heart{
      position:absolute;
      left:50%;
      top:54%;
      font-size: 18px;
      animation: floatUp 1400ms ease-out forwards;
      opacity: 0.85;
      filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2));
    }
    @keyframes floatUp{
      0%{ transform: translate(-50%, 0) scale(.8); opacity:0; }
      10%{ opacity:1; }
      100%{ transform: translate(-50%, -240px) scale(1.25) rotate(-8deg); opacity:0; }
    }

    /* Tap hint */
    .hint{
      position:absolute;
      top: 100%;
      left:50%;
      transform: translate(-50%, 12px);
      font-size: 14px;
      color:#a04e6c;
      opacity:.85;
      background: #fff0f6;
      padding: 6px 10px;
      border-radius: 999px;
      box-shadow: 0 6px 16px rgba(255, 99, 150, 0.18);
      transition: opacity 500ms ease, transform 500ms ease;
      white-space: nowrap;
      font-weight: 700;
    }
    .envelope.open .hint{ opacity:0; transform: translate(-50%, 18px); }

    /* Accessibility focus ring */
    .envelope:focus-visible{
      outline: 4px solid #ffacd0;
      outline-offset: 6px;
      border-radius: 18px;
    }
  </style>
</head>
<body>
  <div class="scene">
    <div class="float-hearts" aria-hidden="true"></div>

    <button class="envelope" id="envelope" aria-label="Open birthday letter for didi">
      <div class="env-base"></div>
      <div class="env-bottom"></div>
      <div class="env-top" id="flap"></div>
      <div class="seal" id="seal" title="Open">
        üíñ
      </div>
      <div class="for-didi">for didi</div>

      <div class="letter" id="letter">
        <div style="width:100%;">
          <div class="greet">Happy Birthday, Didi üéÇ‚ú®</div>
          <div class="divider"></div>
          <div class="typewriter" id="tw">
            <!-- Typed text will appear here -->
            <span class="caret" id="caret"></span>
          </div>
        </div>
        <div class="hint">Tap the envelope</div>
      </div>
    </button>
  </div>

  <script>
    // Confetti instance (create only once as per library note) [web:10]
    const jsConfetti = new JSConfetti();

    const envelope = document.getElementById('envelope');
    const typeBox = document.getElementById('tw');
    const caret = document.getElementById('caret');
    const heartsLayer = document.querySelector('.float-hearts');

    const message = "Happy Birthday didi üéâüíñ\nThanks for always supporting me and standing firm behind me.\nYou gave me strength and I'm there too always ‚Äî Your Rugved.\nWishing you a happy B'day! Love you, dida ü•∞üéÇüåü"; // [web:8]

    let hasOpened = false;
    let typing = false;

    function spawnHeartsBurst(){
      const emojis = ['üíñ','üíó','üíì','üíï','üíû','üíù','üå∏','‚ú®'];
      for(let i=0;i<12;i++){
        const span = document.createElement('span');
        span.className = 'heart';
        span.textContent = emojis[Math.floor(Math.random()*emojis.length)];
        const jitterX = (Math.random()*220 - 110);
        const delay = Math.random()*180;
        span.style.left = `calc(50% + ${jitterX}px)`;
        span.style.animationDelay = `${delay}ms`;
        span.style.fontSize = `${18 + Math.random()*10}px`;
        heartsLayer.appendChild(span);
        setTimeout(()=> span.remove(), 1800 + delay + 200);
      }
    }

    function typeWriterText(text, speed = 26){
      if(typing) return;
      typing = true;

      // Remove existing caret temporarily during typing
      if(caret && caret.parentNode) caret.remove();

      const span = document.createElement('span');
      let i = 0;
      typeBox.appendChild(span);

      function tick(){
        if(i <= text.length){
          const ch = text[i] || '';
          span.textContent += ch;
          i++;
          setTimeout(tick, speed + Math.round(Math.random()*24));
        } else {
          // Re-attach blinking caret
          if(caret) typeBox.appendChild(caret);
          typing = false;
        }
      }
      tick();
    }

    function openEnvelope(){
      if(hasOpened) return;
      hasOpened = true;

      envelope.classList.add('open');

      // Confetti burst with emojis and colors (the lib supports emojis) [web:10][web:7]
      jsConfetti.addConfetti({
        emojis: ['üíñ','üéâ','üéÇ','üåü','üíù','‚ú®'],
        emojiSize: 44,
        confettiNumber: 70,
      });
      // Follow-up color confetti
      setTimeout(()=>{
        jsConfetti.addConfetti({
          confettiColors: ['#ff3d85','#ff9ec2','#ffd3e6','#ffffff','#ffc2dd'],
          confettiRadius: 5,
          confettiNumber: 120,
        });
      }, 450);

      spawnHeartsBurst();

      // Start the typewriter after flap animation
      setTimeout(()=>{
        typeWriterText(message, 24); // [web:8]
      }, 700);
    }

    // Click or keyboard access
    envelope.addEventListener('click', openEnvelope);
    envelope.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        openEnvelope();
      }
    });

    // Optional: gentle nudge animation for the seal to invite interaction
    let nudgeTimer = null;
    const seal = document.getElementById('seal');
    function nudgeSeal(){
      if(hasOpened) return;
      seal.animate(
        [
          { transform: 'translate(-50%, -50%) scale(1)' },
          { transform: 'translate(-50%, -52%) scale(1.06)' },
          { transform: 'translate(-50%, -50%) scale(1)' }
        ],
        { duration: 900, easing: 'ease', iterations: 1 }
      );
    }
    nudgeTimer = setInterval(nudgeSeal, 2200);

    // Clean up nudge when opened
    const observer = new MutationObserver(()=>{
      if(envelope.classList.contains('open')){
        clearInterval(nudgeTimer);
      }
    });
    observer.observe(envelope, { attributes:true, attributeFilter:['class'] });
  </script>
</body>
</html>
